@baseUrl = http://localhost:3000
@contentType = application/json

# ==========================================
# 1. FLUXO DE CRIAÇÃO E MANIPULAÇÃO (CRUD)
# ==========================================
# Este fluxo cria um post e utiliza o ID retornado para as operações subsequentes.
# Ideal para testar em um banco limpo sem depender de IDs hardcoded.

### 1.1 Criar um novo Post
# @name createPost
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
    "titulo": "Post de Teste Automatizado",
    "conteudo": "Este conteúdo serve para validar o fluxo de criação e recuperação de ID dinâmico.",
    "autor": "QA Tester"
}

### 1.2 Buscar o post recém-criado (Usa o ID do passo anterior)
@postId = {{createPost.response.body.id}}
GET {{baseUrl}}/posts/{{postId}}

### 1.3 Atualizar o post criado
PUT {{baseUrl}}/posts/{{postId}}
Content-Type: {{contentType}}

{
    "titulo": "Título Atualizado Dinamicamente",
    "conteudo": "O conteúdo foi alterado com sucesso."
}

### 1.4 Lista todos os posts (deve conter o post atualizado)
GET {{baseUrl}}/posts/

### 1.5 Deletar o post criado
DELETE {{baseUrl}}/posts/{{postId}}

### 1.6 Confirmar exclusão (Deve retornar 404)
GET {{baseUrl}}/posts/{{postId}}


# ==========================================
# 2. LISTAGEM E BUSCA
# ==========================================
# Popula o banco com alguns itens para testar listas e buscas.

### 2.1 Criar Post sobre Node.js
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
    "titulo": "Introdução ao Node.js",
    "conteudo": "Node.js permite executar JavaScript no servidor com alta performance.",
    "autor": "Professor Node"
}

### 2.2 Criar Post sobre Docker
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
    "titulo": "Docker para Iniciantes",
    "conteudo": "Containerização facilita o deploy e garante consistência de ambiente.",
    "autor": "Professor Docker"
}

### 2.3 Listar todos os posts
GET {{baseUrl}}/posts

### 2.4 Buscar por palavra-chave "Node"
GET {{baseUrl}}/posts/search?q=Node

### 2.5 Buscar por palavra-chave "Container" (no conteúdo)
GET {{baseUrl}}/posts/search?q=Container


# ==========================================
# 3. ALGUNS TESTES DE VALIDAÇÃO E ERROS
# ==========================================

### 3.1 Erro: Buscar ID inexistente
GET {{baseUrl}}/posts/999999

### 3.2 Erro: ID com formato inválido
GET {{baseUrl}}/posts/abc-123

### 3.3 Erro: Criar post com dados inválidos (Título curto)
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
    "titulo": "Oi",
    "conteudo": "Conteúdo válido, mas o título é muito curto.",
    "autor": "Tester"
}

### 3.4 Erro: Atualizar post inexistente
PUT {{baseUrl}}/posts/999999
Content-Type: {{contentType}}

{
    "titulo": "Tentativa de Update"
}

### 3.5 Erro: Busca com termo muito curto
GET {{baseUrl}}/posts/search?q=a